<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Figma Fast Track: ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡πÄ‡∏ä‡∏¥‡∏á‡πÇ‡∏ï‡πâ‡∏ï‡∏≠‡∏ö</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans Thai', sans-serif; }
        
        /* Device Frames */
        .device-container {
            transition: all 0.5s ease;
        }

        .iphone-frame {
            width: 300px;
            height: 600px;
            border: 12px solid #333;
            border-radius: 40px;
            overflow: hidden;
            position: relative;
            background: white;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            margin: 0 auto;
        }
        .notch {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 25px;
            background: #333;
            border-bottom-left-radius: 12px;
            border-bottom-right-radius: 12px;
            z-index: 20;
        }

        .desktop-frame {
            width: 100%;
            height: 400px;
            border: 8px solid #333;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            background: white;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            display: flex; /* For split screen layout */
        }
        
        .desktop-stand {
            width: 120px;
            height: 20px;
            background: #cbd5e1;
            margin: 0 auto;
            border-bottom-left-radius: 8px;
            border-bottom-right-radius: 8px;
        }

        /* Chart Container Styles */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 300px;
        }

        /* Custom Scrollbar */
        .steps-scroll::-webkit-scrollbar { width: 6px; }
        .steps-scroll::-webkit-scrollbar-track { background: #f1f1f1; }
        .steps-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        .steps-scroll::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Animation classes */
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Component Visuals */
        .component-outline { border: 1px dashed #8b5cf6; position: relative; }
        .component-badge { position: absolute; top: -8px; left: -8px; width: 16px; height: 16px; background: #8b5cf6; transform: rotate(45deg); }
        
        /* Responsive Simulation Helpers */
        .resize-handle {
            position: absolute;
            right: 0; top: 0; bottom: 0; width: 4px;
            background: rgba(59, 130, 246, 0.5);
            cursor: ew-resize;
            z-index: 50;
        }
    </style>
</head>
<body class="bg-stone-50 text-slate-800 h-screen flex flex-col overflow-hidden">

    <!-- Header -->
    <header class="bg-white border-b border-stone-200 shadow-sm flex-none z-10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center text-white font-bold">F</div>
                <h1 class="text-xl font-bold text-slate-800 hidden sm:block">Figma Fast Track Guide</h1>
                
                <!-- Course Selector -->
                <div class="ml-4 flex bg-stone-100 p-1 rounded-lg">
                    <button onclick="switchCourse('c1')" id="btn-c1" class="px-3 py-1 text-sm rounded-md font-medium transition-all">Mobile App</button>
                    <button onclick="switchCourse('c2')" id="btn-c2" class="px-3 py-1 text-sm rounded-md font-medium transition-all">Desktop Responsive</button>
                </div>
            </div>
            <div class="flex items-center gap-4">
                <div class="text-right hidden md:block">
                    <p class="text-xs text-slate-500 uppercase tracking-wider">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
                    <div class="w-32 h-2 bg-stone-200 rounded-full mt-1 overflow-hidden">
                        <div id="global-progress" class="h-full bg-orange-500 w-0 transition-all duration-500"></div>
                    </div>
                </div>
                <button onclick="resetProgress()" class="text-xs text-indigo-600 hover:text-indigo-800 font-medium whitespace-nowrap">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
            </div>
        </div>
    </header>

    <!-- Main Content Layout -->
    <main class="flex-1 flex flex-col lg:flex-row overflow-hidden max-w-7xl mx-auto w-full">
        
        <!-- Sidebar Navigation -->
        <nav class="w-full lg:w-64 bg-white border-r border-stone-200 flex-none flex lg:flex-col overflow-x-auto lg:overflow-y-auto">
            <div class="p-4 hidden lg:block bg-stone-50 border-b border-stone-100">
                <h2 id="course-title-display" class="text-xs font-bold text-indigo-600 uppercase tracking-wider mb-1">Course 1</h2>
                <p id="course-desc-display" class="text-xs text-slate-500 truncate">Mobile App Login Screen</p>
            </div>
            <div class="flex lg:block w-full" id="nav-container">
                <!-- Nav items generated by JS -->
            </div>
        </nav>

        <!-- Dynamic Content Area -->
        <section class="flex-1 flex flex-col min-w-0 bg-stone-50 relative overflow-hidden">
            <div id="phase-content" class="flex-1 overflow-y-auto p-4 lg:p-8 scroll-smooth">
                <!-- Content injected here -->
            </div>
        </section>

        <!-- Visual Simulation Panel (Right Side on Desktop) -->
        <aside class="hidden xl:block w-[450px] bg-stone-100 border-l border-stone-200 flex-none p-6 overflow-y-auto">
            <div class="sticky top-0">
                <h3 class="text-sm font-bold text-slate-600 uppercase mb-4 text-center">Visual Preview: <span id="preview-label" class="text-indigo-600">Overview</span></h3>
                
                <!-- Chart Container -->
                <div id="chart-wrapper" class="chart-container mb-8">
                    <canvas id="timeChart"></canvas>
                </div>

                <!-- Simulation Container -->
                <div id="simulation-wrapper" class="hidden flex flex-col items-center w-full">
                    
                    <!-- Dynamic Frame Injection Point -->
                    <div id="frame-container" class="device-container w-full flex flex-col items-center">
                        <!-- iPhone or Desktop Frame will be rendered here -->
                    </div>

                    <p class="text-xs text-center text-slate-400 mt-4">‡∏†‡∏≤‡∏û‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÉ‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</p>
                    <div id="sim-notes" class="mt-2 text-xs text-slate-500 text-center px-4 italic"></div>
                    
                    <!-- Prototype Controls -->
                    <div id="proto-controls" class="hidden mt-4 bg-white p-3 rounded shadow-sm w-full">
                        <p class="text-xs font-bold mb-2">‡∏ó‡∏î‡∏™‡∏≠‡∏ö Prototype:</p>
                        <button id="sim-reset-btn" class="w-full py-1 bg-stone-200 text-xs rounded hover:bg-stone-300">Restart Flow</button>
                    </div>
                </div>
            </div>
        </aside>

    </main>

    <!-- Mobile/Tablet Preview Modal -->
    <button onclick="toggleMobilePreview()" class="xl:hidden fixed bottom-6 right-6 w-14 h-14 bg-indigo-600 text-white rounded-full shadow-lg flex items-center justify-center z-50 hover:bg-indigo-700 transition-colors" title="‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á">
        <span class="text-2xl">üëÅÔ∏è</span>
    </button>
    <div id="mobile-preview-modal" class="fixed inset-0 bg-black/80 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-stone-100 rounded-xl w-full max-w-md h-[90vh] overflow-y-auto relative flex flex-col">
            <button onclick="toggleMobilePreview()" class="absolute top-4 right-4 text-slate-600 hover:text-red-500 z-50 bg-white rounded-full p-1">‚úï</button>
            <div class="p-6 flex-1 flex flex-col items-center">
                <h3 class="text-lg font-bold text-slate-700 mb-6">Visual Preview</h3>
                <div id="mobile-chart-wrapper" class="chart-container w-full mb-6"></div>
                <div id="mobile-sim-wrapper" class="flex flex-col items-center w-full"></div>
            </div>
        </div>
    </div>

    <!-- JavaScript Logic -->
    <script>
        // --- Course Data Structure ---
        const courses = {
            c1: {
                id: 'c1',
                title: 'Course 1: Mobile App',
                description: '‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á Login Screen ‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠',
                phases: [
                    {
                        id: 'c1-overview',
                        title: '‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° & ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô',
                        duration: '3 - 3.5 ‡∏ä‡∏°.',
                        color: 'text-indigo-600',
                        description: '‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô: ‡∏™‡∏£‡πâ‡∏≤‡∏á Mobile Login Screen ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏à‡∏ô‡∏ñ‡∏∂‡∏á Prototype',
                        steps: [
                            { text: '‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢: ‡∏™‡∏£‡πâ‡∏≤‡∏á Login Screen + Design System', done: false },
                            { text: '‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à 5 ‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏Å: Structure, Auto Layout, Components, Styles, Constraints', done: false },
                            { text: '‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏•‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏≥', done: false }
                        ]
                    },
                    {
                        id: 'c1-p1',
                        title: 'Phase 1: Setup & Structure',
                        duration: '45 ‡∏ô‡∏≤‡∏ó‡∏µ',
                        color: 'text-teal-500',
                        description: '‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÅ‡∏•‡∏∞ Constraints ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô',
                        steps: [
                            { text: '‡∏™‡∏£‡πâ‡∏≤‡∏á Frame iPhone 15', detail: '‡∏Å‡∏î F ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Phone -> iPhone 15', done: false },
                            { text: '‡∏™‡∏£‡πâ‡∏≤‡∏á Text "Welcome"', detail: '‡∏Å‡∏î T ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°', done: false },
                            { text: '‡∏™‡∏£‡πâ‡∏≤‡∏á Input (‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏° + Text)', detail: '‡∏Å‡∏î R ‡∏ß‡∏≤‡∏î‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°, ‡∏Å‡∏î T ‡∏û‡∏¥‡∏°‡∏û‡πå Label', done: false },
                            { text: '‡∏Å‡∏≥‡∏´‡∏ô‡∏î Constraints', detail: '‡πÉ‡∏´‡πâ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á Input ‡∏¢‡∏∂‡∏î Left & Right', done: false },
                            { text: '‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏° Login', detail: '‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô + ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß', done: false }
                        ]
                    },
                    {
                        id: 'c1-p2',
                        title: 'Phase 2: Auto Layout & Plugins',
                        duration: '45 ‡∏ô‡∏≤‡∏ó‡∏µ',
                        color: 'text-emerald-500',
                        description: '‡∏à‡∏±‡∏î‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏î‡πâ‡∏ß‡∏¢ Auto Layout ‡πÅ‡∏•‡∏∞‡πÉ‡∏™‡πà‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô',
                        steps: [
                            { text: 'Auto Layout ‡∏õ‡∏∏‡πà‡∏° Login', detail: '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°+‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° -> Shift+A', done: false },
                            { text: 'Auto Layout ‡∏ä‡πà‡∏≠‡∏á Input', detail: '‡∏ó‡∏≥‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô‡∏Å‡∏±‡∏ö‡∏ä‡πà‡∏≠‡∏á Email/Password', done: false },
                            { text: '‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Plugin Iconify', detail: '‡πÉ‡∏™‡πà‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô Email, Eye', done: false },
                            { text: '‡πÉ‡∏™‡πà‡∏£‡∏π‡∏õ Logo', detail: '‡πÉ‡∏ä‡πâ Plugin Unsplash', done: false }
                        ]
                    },
                    {
                        id: 'c1-p3',
                        title: 'Phase 3: Design System',
                        duration: '45 ‡∏ô‡∏≤‡∏ó‡∏µ',
                        color: 'text-purple-500',
                        description: '‡∏™‡∏£‡πâ‡∏≤‡∏á Styles ‡πÅ‡∏•‡∏∞ Components',
                        steps: [
                            { text: '‡∏™‡∏£‡πâ‡∏≤‡∏á Color Styles', detail: 'Primary, Text, Surface', done: false },
                            { text: '‡∏™‡∏£‡πâ‡∏≤‡∏á Component (‡∏õ‡∏∏‡πà‡∏°)', detail: '‡∏Å‡∏î Create Component (‚ùñ)', done: false },
                            { text: '‡∏ô‡∏≥ Instance ‡πÑ‡∏õ‡πÉ‡∏ä‡πâ', detail: 'Alt + Drag ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡∏£‡∏¥‡∏á', done: false }
                        ]
                    },
                    {
                        id: 'c1-p4',
                        title: 'Phase 4: Prototype',
                        duration: '30 ‡∏ô‡∏≤‡∏ó‡∏µ',
                        color: 'text-pink-500',
                        description: '‡∏™‡∏£‡πâ‡∏≤‡∏á Interaction ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠',
                        steps: [
                            { text: 'Duplicate ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Success', detail: '‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå', done: false },
                            { text: '‡πÄ‡∏Ç‡πâ‡∏≤‡πÇ‡∏´‡∏°‡∏î Prototype', detail: '‡∏•‡∏≤‡∏Å‡πÄ‡∏™‡πâ‡∏ô‡∏à‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏°‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Success', done: false },
                            { text: 'Present', detail: '‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° Play ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö', done: false }
                        ]
                    }
                ]
            },
            c2: {
                id: 'c2',
                title: 'Course 2: Desktop Responsive',
                description: '‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ Login ‡πÅ‡∏ö‡∏ö Split Screen ‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡∏î‡∏´‡∏î‡πÑ‡∏î‡πâ',
                phases: [
                    {
                        id: 'c2-overview',
                        title: '‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°: Responsive Layout',
                        duration: '1 ‡∏ä‡∏°.',
                        color: 'text-orange-600',
                        description: '‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ Auto Layout ‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ Desktop ‡πÅ‡∏ö‡∏ö Split Screen (‡πÅ‡∏ö‡πà‡∏á‡∏Ñ‡∏£‡∏∂‡πà‡∏á)',
                        steps: [
                            { text: 'Concept: ‡πÄ‡∏•‡∏¥‡∏Å‡πÉ‡∏ä‡πâ‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ö‡∏ö‡∏≠‡∏¥‡∏™‡∏£‡∏∞ (Freeform)', done: false },
                            { text: 'Concept: Hierarchy ‡∏Ç‡∏≠‡∏á Auto Layout (Container ‡∏ã‡πâ‡∏≠‡∏ô Container)', done: false },
                            { text: 'Goal: ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡∏î‡∏´‡∏î‡∏ï‡∏≤‡∏°‡∏Ç‡∏ô‡∏≤‡∏î‡∏à‡∏≠‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á', done: false }
                        ]
                    },
                    {
                        id: 'c2-p1',
                        title: 'Technique: Responsive Structure',
                        duration: '30 ‡∏ô‡∏≤‡∏ó‡∏µ',
                        color: 'text-blue-600',
                        description: '‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢ Auto Layout',
                        steps: [
                            { text: '‡∏™‡∏£‡πâ‡∏≤‡∏á Form Container (‡∏Ç‡∏ß‡∏≤)', detail: '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Text, Inputs ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î -> ‡∏Å‡∏î Shift+A (‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á, Gap 24px)', done: false },
                            { text: '‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Inputs ‡πÄ‡∏õ‡πá‡∏ô Fill container', detail: '‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏¢‡∏∑‡∏î‡πÄ‡∏ï‡πá‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á Form Container', done: false },
                            { text: '‡∏™‡∏£‡πâ‡∏≤‡∏á Main Container', detail: '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û(‡∏ã‡πâ‡∏≤‡∏¢) + Form(‡∏Ç‡∏ß‡∏≤) -> ‡∏Å‡∏î Shift+A (‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô)', done: false },
                            { text: '‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Main Layout', detail: 'Spacing Mode: Auto (‡∏´‡∏£‡∏∑‡∏≠ 0), Image: Fill container', done: false },
                            { text: '‡∏ó‡∏î‡∏™‡∏≠‡∏ö Responsive', detail: '‡∏•‡∏≠‡∏á‡∏•‡∏≤‡∏Å‡∏Ç‡∏≠‡∏ö Frame ‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤-‡∏≠‡∏≠‡∏Å ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏¢‡∏±‡∏ö‡∏ï‡∏≤‡∏°', done: false }
                        ]
                    },
                    {
                        id: 'c2-p2',
                        title: 'Design: Pro UI & Hierarchy',
                        duration: '30 ‡∏ô‡∏≤‡∏ó‡∏µ',
                        color: 'text-indigo-600',
                        description: '‡∏≠‡∏±‡∏õ‡πÄ‡∏Å‡∏£‡∏î‡∏î‡∏µ‡πÑ‡∏ã‡∏ô‡πå‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏∑‡∏≠‡∏≠‡∏≤‡∏ä‡∏µ‡∏û',
                        steps: [
                            { text: 'Input Fields ‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÉ‡∏´‡∏°‡πà', detail: '‡∏û‡∏∑‡πâ‡∏ô‡∏Ç‡∏≤‡∏ß, ‡πÄ‡∏™‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö‡πÄ‡∏ó‡∏≤‡∏≠‡πà‡∏≠‡∏ô, ‡∏°‡∏∏‡∏°‡∏°‡∏ô 4-8px, ‡∏°‡∏µ Placeholder', done: false },
                            { text: '‡πÄ‡∏û‡∏¥‡πà‡∏° Icons ‡πÉ‡∏ô Input', detail: '‡πÉ‡∏™‡πà‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô User/Lock ‡∏´‡∏ô‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡∏µ‡πÄ‡∏°‡∏µ‡∏¢‡∏°', done: false },
                            { text: '‡∏õ‡∏∏‡πà‡∏° Log In ‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡πà‡∏ô‡∏ä‡∏±‡∏î', detail: '‡∏™‡∏µ Primary ‡∏™‡∏î‡πÉ‡∏™, ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏´‡∏ô‡∏≤ (Bold)', done: false },
                            { text: '‡∏à‡∏±‡∏î Typography', detail: 'Heading ‡πÉ‡∏´‡∏ç‡πà (32px+), Label ‡∏ï‡∏±‡∏ß‡∏ï‡∏£‡∏á (‡πÑ‡∏°‡πà‡πÄ‡∏≠‡∏µ‡∏¢‡∏á) ‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡πÄ‡∏Ç‡πâ‡∏°', done: false },
                            { text: '‡πÄ‡∏û‡∏¥‡πà‡∏° Logo ‡πÅ‡∏•‡∏∞ Forgot Password', detail: '‡∏à‡∏±‡∏î‡∏ß‡∏≤‡∏á‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö ‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏° Padding ‡πÉ‡∏´‡πâ‡πÑ‡∏°‡πà‡∏≠‡∏∂‡∏î‡∏≠‡∏±‡∏î', done: false }
                        ]
                    }
                ]
            },
            shortcuts: {
                id: 'shortcuts',
                title: '‡∏†‡∏≤‡∏Ñ‡∏ú‡∏ô‡∏ß‡∏Å: Shortcuts',
                description: '‡∏£‡∏ß‡∏°‡∏Ñ‡∏µ‡∏¢‡πå‡∏•‡∏±‡∏î‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç',
                phases: [] // Special case handled by render logic
            }
        };

        const shortcutsData = [
            { key: 'F', action: 'Frame', category: 'Tools' },
            { key: 'Shift + A', action: 'Auto Layout', category: 'Essential' },
            { key: 'Ctrl + Alt + K', action: 'Create Component', category: 'System' },
            { key: 'Alt + H / V', action: 'Align Center', category: 'Layout' },
            { key: 'Shift + Enter', action: 'Select Parent', category: 'Selection' },
            { key: 'Enter', action: 'Select Children', category: 'Selection' }
        ];

        // --- State ---
        let currentCourseId = 'c1';
        let currentPhaseId = 'c1-overview';
        let progressData = JSON.parse(localStorage.getItem('figmaGuideProgress_v3')) || {};
        let timeChart = null;

        // --- DOM Elements ---
        const navContainer = document.getElementById('nav-container');
        const phaseContent = document.getElementById('phase-content');
        const frameContainer = document.getElementById('frame-container');
        const simNotes = document.getElementById('sim-notes');
        const chartWrapper = document.getElementById('chart-wrapper');
        const simulationWrapper = document.getElementById('simulation-wrapper');

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            loadCourse('c1');
        });

        // --- Functions ---

        function switchCourse(courseId) {
            loadCourse(courseId);
        }

        function loadCourse(courseId) {
            currentCourseId = courseId;
            
            // UI Toggle
            document.getElementById('btn-c1').className = `px-3 py-1 text-sm rounded-md font-medium transition-all ${courseId === 'c1' ? 'bg-white text-indigo-600 shadow-sm' : 'text-slate-500 hover:text-slate-700'}`;
            document.getElementById('btn-c2').className = `px-3 py-1 text-sm rounded-md font-medium transition-all ${courseId === 'c2' ? 'bg-white text-indigo-600 shadow-sm' : 'text-slate-500 hover:text-slate-700'}`;
            
            // Header Info
            document.getElementById('course-title-display').innerText = courses[courseId].title;
            document.getElementById('course-desc-display').innerText = courses[courseId].description;

            // Load first phase of course
            const firstPhase = courses[courseId].phases[0];
            loadPhase(firstPhase.id);
            updateGlobalProgress();
        }

        function renderNav() {
            navContainer.innerHTML = '';
            const activeCourse = courses[currentCourseId];
            
            // Add Phases
            activeCourse.phases.forEach(phase => {
                const btn = document.createElement('button');
                btn.className = `w-full text-left px-4 py-3 border-l-4 transition-colors flex flex-col gap-1 ${currentPhaseId === phase.id ? 'border-indigo-600 bg-indigo-50' : 'border-transparent hover:bg-stone-50'}`;
                btn.onclick = () => loadPhase(phase.id);
                btn.innerHTML = `
                    <span class="font-medium text-sm ${currentPhaseId === phase.id ? 'text-indigo-700' : 'text-slate-600'}">${phase.title}</span>
                    <span class="text-xs text-slate-400">${phase.duration}</span>
                `;
                navContainer.appendChild(btn);
            });

            // Add Shortcuts Link
            const scBtn = document.createElement('button');
            scBtn.className = `w-full text-left px-4 py-3 border-l-4 transition-colors flex flex-col gap-1 ${currentPhaseId === 'shortcuts' ? 'border-indigo-600 bg-indigo-50' : 'border-transparent hover:bg-stone-50'}`;
            scBtn.onclick = () => loadPhase('shortcuts');
            scBtn.innerHTML = `<span class="font-medium text-sm text-slate-600">‡∏†‡∏≤‡∏Ñ‡∏ú‡∏ô‡∏ß‡∏Å: Shortcuts</span>`;
            navContainer.appendChild(scBtn);
        }

        function loadPhase(id) {
            currentPhaseId = id;
            renderNav();
            renderContent(id);
            updatePreview(id);
            updateGlobalProgress();
        }

        function renderContent(id) {
            if (id === 'shortcuts') {
                phaseContent.innerHTML = renderShortcutsTable();
                return;
            }

            const activeCourse = courses[currentCourseId];
            const phase = activeCourse.phases.find(p => p.id === id);

            const stepsHtml = phase.steps.map((step, index) => {
                const stepId = `${id}-${index}`;
                const isChecked = progressData[stepId] || false;
                return `
                    <div class="flex items-start gap-4 p-4 bg-white rounded-xl border border-stone-200 shadow-sm transition-all hover:shadow-md ${isChecked ? 'opacity-70 bg-stone-50' : ''}">
                        <div class="flex-none pt-1">
                            <input type="checkbox" id="${stepId}" class="w-5 h-5 text-indigo-600 rounded focus:ring-indigo-500 cursor-pointer" ${isChecked ? 'checked' : ''} onchange="toggleStep('${stepId}')">
                        </div>
                        <div class="flex-1">
                            <label for="${stepId}" class="font-medium text-slate-800 cursor-pointer select-none ${isChecked ? 'line-through text-slate-400' : ''}">${step.text}</label>
                            ${step.detail ? `<p class="text-sm text-slate-500 mt-1">${step.detail}</p>` : ''}
                        </div>
                    </div>
                `;
            }).join('');

            phaseContent.innerHTML = `
                <div class="max-w-3xl mx-auto fade-in">
                    <div class="mb-6">
                        <span class="inline-block px-2 py-1 bg-stone-200 text-stone-600 text-xs font-bold rounded uppercase mb-2">${phase.duration}</span>
                        <h2 class="text-3xl font-bold ${phase.color} mb-2">${phase.title}</h2>
                        <p class="text-slate-600 text-lg">${phase.description}</p>
                        ${(id.includes('overview')) ? `
                            <div class="mt-6 pt-4 border-t border-stone-200">
                                <a href="https://www.figma.com" target="_blank" class="inline-flex items-center gap-2 px-4 py-2 bg-black text-white rounded-lg hover:bg-stone-800 transition-colors mb-4">
                                    <span>‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Figma.com</span><span class="text-xs">‚Üó</span>
                                </a>
                                <p class="text-sm text-slate-500 font-medium">Credit by Gemini & Kamthorn Sarawan</p>
                            </div>` : ''}
                    </div>
                    <div class="space-y-4">${stepsHtml}</div>
                </div>
            `;
        }

        function renderShortcutsTable() {
            return `
                <div class="max-w-3xl mx-auto fade-in">
                    <h2 class="text-3xl font-bold text-slate-700 mb-6">Shortcuts Cheat Sheet</h2>
                    <div class="bg-white rounded-xl shadow-sm border border-stone-200 overflow-hidden">
                        <table class="w-full text-left">
                            <thead class="bg-stone-50 text-xs text-slate-500 uppercase">
                                <tr><th class="px-6 py-3">Key</th><th class="px-6 py-3">Action</th><th class="px-6 py-3">Category</th></tr>
                            </thead>
                            <tbody class="divide-y divide-stone-200">
                                ${shortcutsData.map(s => `<tr><td class="px-6 py-4 font-mono font-bold text-indigo-600">${s.key}</td><td class="px-6 py-4">${s.action}</td><td class="px-6 py-4"><span class="px-2 py-1 bg-stone-100 rounded text-xs text-slate-600">${s.category}</span></td></tr>`).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>`;
        }

        function toggleStep(stepId) {
            progressData[stepId] = !progressData[stepId];
            localStorage.setItem('figmaGuideProgress_v3', JSON.stringify(progressData));
            loadPhase(currentPhaseId);
        }

        function updateGlobalProgress() {
            let total = 0, completed = 0;
            // Count all phases in current course only
            courses[currentCourseId].phases.forEach(p => {
                p.steps.forEach((s, idx) => {
                    total++;
                    if (progressData[`${p.id}-${idx}`]) completed++;
                });
            });
            const pct = total === 0 ? 0 : (completed / total) * 100;
            document.getElementById('global-progress').style.width = `${pct}%`;
        }

        function resetProgress() {
            if(confirm('‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?')) {
                progressData = {};
                localStorage.removeItem('figmaGuideProgress_v3');
                loadPhase(currentPhaseId);
            }
        }

        // --- Visual Simulation ---

        function updatePreview(id) {
            const label = document.getElementById('preview-label');
            
            if (id === 'shortcuts') {
                chartWrapper.classList.add('hidden');
                simulationWrapper.classList.add('hidden');
                return;
            }

            const activeCourse = courses[currentCourseId];
            const phase = activeCourse.phases.find(p => p.id === id);
            label.innerText = phase.title;

            if (id.includes('overview')) {
                chartWrapper.classList.remove('hidden');
                simulationWrapper.classList.add('hidden');
                renderTimeChart(currentCourseId);
            } else {
                chartWrapper.classList.add('hidden');
                simulationWrapper.classList.remove('hidden');
                renderFrame(currentCourseId, id);
            }
        }

        function renderTimeChart(courseId) {
            const ctx = document.getElementById('timeChart').getContext('2d');
            if (timeChart) timeChart.destroy();
            
            const data = courseId === 'c1' 
                ? [15, 45, 45, 45, 30] // Course 1 times
                : [60, 30, 30];        // Course 2 times (Overview, Tech, Design)
            
            const labels = courseId === 'c1'
                ? ['Phase 1', 'Phase 2', 'Phase 3', 'Phase 4', 'Phase 5']
                : ['Overview', 'Technique', 'Design'];

            timeChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: ['#3b82f6', '#14b8a6', '#10b981', '#a855f7', '#ec4899'],
                        borderWidth: 0
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom' } } }
            });
        }

        function renderFrame(courseId, phaseId) {
            const container = document.getElementById('frame-container');
            const notes = document.getElementById('sim-notes');
            const controls = document.getElementById('proto-controls');
            controls.classList.add('hidden');
            container.innerHTML = ''; // Clear

            if (courseId === 'c1') {
                // Mobile Frame
                const frame = document.createElement('div');
                frame.className = 'iphone-frame flex flex-col items-center justify-center bg-white transition-all duration-500';
                frame.innerHTML = `<div class="notch"></div><div id="sim-content" class="w-full h-full p-6 relative flex flex-col"></div>`;
                container.appendChild(frame);
                renderMobileContent(phaseId, frame.querySelector('#sim-content'), notes, controls);
            } else {
                // Desktop Frame
                const frame = document.createElement('div');
                frame.className = 'desktop-frame fade-in';
                // Split Screen Layout
                frame.innerHTML = `
                    <div id="desktop-left" class="h-full transition-all duration-500 relative overflow-hidden bg-slate-200 flex items-center justify-center"></div>
                    <div id="desktop-right" class="h-full bg-white flex flex-col justify-center px-8 transition-all duration-500 relative"></div>
                `;
                const stand = document.createElement('div');
                stand.className = 'desktop-stand';
                container.appendChild(frame);
                container.appendChild(stand);
                renderDesktopContent(phaseId, frame, notes);
            }
        }

        // --- Content for Simulations ---

        function renderMobileContent(phaseId, content, notes, controls) {
            // Simplified Logic from previous version for C1
            if (phaseId === 'c1-p1') {
                 content.innerHTML = `
                    <div class="mt-20 flex flex-col gap-4 fade-in">
                        <div class="text-2xl font-bold border border-dashed border-blue-400 p-1">Welcome</div>
                        <div class="h-12 bg-stone-100 border flex items-center px-3 text-stone-400">Email</div>
                        <div class="h-12 bg-blue-600 flex items-center justify-center text-white">Login</div>
                    </div>`;
                 notes.innerText = "Wireframe: ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô";
            } else if (phaseId === 'c1-p2' || phaseId === 'c1-p3') {
                content.innerHTML = `
                    <div class="mt-16 flex flex-col gap-4 items-center fade-in">
                        <div class="w-16 h-16 rounded-full bg-indigo-100 flex items-center justify-center text-2xl">üë§</div>
                        <div class="text-2xl font-bold">Welcome</div>
                        <div class="w-full p-3 bg-stone-50 rounded-xl border flex gap-2"><span class="text-stone-400">üìß</span><span class="text-sm text-stone-400">Email</span></div>
                        <div class="w-full p-3 bg-stone-50 rounded-xl border flex gap-2"><span class="text-stone-400">üîí</span><span class="text-sm text-stone-400">Pass</span></div>
                        <div class="component-outline w-full p-1 rounded-xl"><button class="w-full py-3 bg-blue-600 text-white font-bold rounded-xl">Login</button></div>
                    </div>`;
                notes.innerText = phaseId === 'c1-p3' ? "Design System: Component ‡∏™‡∏µ‡∏°‡πà‡∏ß‡∏á" : "Auto Layout & Icons";
            } else if (phaseId === 'c1-p4') {
                controls.classList.remove('hidden');
                content.innerHTML = `
                    <div id="m-login" class="mt-16 flex flex-col gap-4 items-center h-full">
                        <div class="text-2xl font-bold">Welcome</div>
                        <div class="w-full p-3 bg-stone-50 rounded-xl border">Email</div>
                        <button onclick="document.getElementById('m-login').classList.add('hidden');document.getElementById('m-success').classList.remove('hidden')" class="w-full py-3 bg-blue-600 text-white font-bold rounded-xl shadow-lg active:scale-95">Login</button>
                    </div>
                    <div id="m-success" class="hidden h-full flex flex-col items-center justify-center"><div class="text-4xl">üéâ</div><div class="font-bold mt-2">Success!</div></div>
                `;
                document.getElementById('sim-reset-btn').onclick = () => renderFrame('c1', 'c1-p4');
                notes.innerText = "Interactive Prototype";
            }
        }

        function renderDesktopContent(phaseId, frame, notes) {
            const left = frame.querySelector('#desktop-left');
            const right = frame.querySelector('#desktop-right');

            if (phaseId === 'c2-p1') {
                // Technique: Blocks illustrating Auto Layout
                left.className = "h-full w-1/2 bg-red-100 flex items-center justify-center border-r-2 border-dashed border-red-300";
                right.className = "h-full w-1/2 bg-green-100 flex flex-col justify-center items-center gap-2 p-4";
                
                left.innerHTML = `<span class="text-red-500 font-bold">Image Container</span><br><span class="text-xs text-red-400">(Fill Container)</span>`;
                right.innerHTML = `
                    <div class="w-full h-8 bg-green-200 border border-green-400 flex items-center justify-center text-xs text-green-700">Input (Fill)</div>
                    <div class="w-full h-8 bg-green-200 border border-green-400 flex items-center justify-center text-xs text-green-700">Input (Fill)</div>
                    <div class="text-green-600 font-bold mt-2">Form Container</div>
                `;
                notes.innerText = "Auto Layout Structure: ‡∏ã‡πâ‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏Ç‡∏ß‡∏≤‡∏ü‡∏≠‡∏£‡πå‡∏° ‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏π‡πà‡∏¢‡∏∑‡∏î‡∏´‡∏î‡πÑ‡∏î‡πâ";
            } else if (phaseId === 'c2-p2') {
                // Design: High Fidelity
                left.className = "h-full w-1/2 bg-cover bg-center";
                left.style.backgroundImage = "url('https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80')"; // Mountain image
                left.innerHTML = `<div class="absolute inset-0 bg-blue-900/20"></div>`; // Overlay

                right.className = "h-full w-1/2 bg-white flex flex-col justify-center px-6 lg:px-10";
                right.innerHTML = `
                    <div class="mb-8">
                        <div class="w-8 h-8 bg-blue-600 rounded mb-4"></div> <!-- Logo -->
                        <h2 class="text-2xl font-bold text-slate-800">Welcome back!</h2>
                        <p class="text-slate-400 text-xs mt-1">Please enter your details.</p>
                    </div>
                    <div class="space-y-4 w-full">
                        <div class="space-y-1">
                            <label class="text-xs font-semibold text-slate-600">Email</label>
                            <div class="flex items-center px-3 py-2 border border-slate-200 rounded-lg bg-white focus-within:border-blue-500 transition-colors">
                                <span class="text-slate-400 text-sm mr-2">‚úâÔ∏è</span>
                                <input type="text" placeholder="Enter your email" class="w-full text-sm outline-none bg-transparent placeholder-slate-300" disabled>
                            </div>
                        </div>
                        <div class="space-y-1">
                            <label class="text-xs font-semibold text-slate-600">Password</label>
                            <div class="flex items-center px-3 py-2 border border-slate-200 rounded-lg bg-white">
                                <span class="text-slate-400 text-sm mr-2">üîí</span>
                                <input type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" class="w-full text-sm outline-none bg-transparent placeholder-slate-300" disabled>
                            </div>
                        </div>
                        <div class="flex justify-between items-center">
                            <div class="flex items-center gap-1"><div class="w-3 h-3 border rounded"></div><span class="text-[10px] text-slate-500">Remember</span></div>
                            <span class="text-[10px] text-blue-600 font-semibold cursor-pointer">Forgot password?</span>
                        </div>
                        <button class="w-full py-2 bg-blue-600 text-white font-bold rounded-lg shadow-md hover:bg-blue-700 transition-colors text-sm">Sign In</button>
                    </div>
                `;
                notes.innerText = "Final Design: Typography ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô, ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏≤‡∏¢‡πÉ‡∏à (Whitespace) ‡∏™‡∏°‡∏î‡∏∏‡∏•, ‡∏™‡∏µ Primary ‡πÄ‡∏î‡πà‡∏ô‡∏ä‡∏±‡∏î";
            }
        }

        // Mobile Preview (Generic)
        function toggleMobilePreview() {
            const modal = document.getElementById('mobile-preview-modal');
            const chartW = document.getElementById('chart-wrapper');
            const mobileChartW = document.getElementById('mobile-chart-wrapper');
            const mobileSimW = document.getElementById('mobile-sim-wrapper');

            if (modal.classList.contains('hidden')) {
                // Move Chart
                if (!chartW.classList.contains('hidden')) {
                     mobileChartW.appendChild(document.getElementById('timeChart'));
                }
                // Clone Simulation
                mobileSimW.innerHTML = '';
                const frameContainer = document.getElementById('frame-container');
                if (frameContainer.innerHTML !== '') {
                    const clone = frameContainer.cloneNode(true);
                    // Rebind simple clicks if needed (simplified for C1-P4)
                    const loginBtn = clone.querySelector('button');
                    if(loginBtn && currentPhaseId === 'c1-p4') {
                        loginBtn.onclick = () => {
                             clone.querySelector('#m-login').classList.add('hidden');
                             clone.querySelector('#m-success').classList.remove('hidden');
                        }
                    }
                    mobileSimW.appendChild(clone);
                }
                modal.classList.remove('hidden'); modal.classList.add('flex');
            } else {
                if(mobileChartW.children.length > 0) chartWrapper.appendChild(document.getElementById('timeChart'));
                modal.classList.add('hidden'); modal.classList.remove('flex');
                // Refresh main view to restore bindings
                loadPhase(currentPhaseId); 
            }
        }
    </script>
</body>
</html>